var interfaceHost='http://twly.wiiqq.com/usrv/ossapi'var hrefHost=''var userConfig={hrefUrl:hrefHost+'/oauth2/login',isLoginUrl:interfaceHost+'/ossapi/oauth2/is-login',userDetailUrl:interfaceHost+'/ossapi/admin/detail',logoutUrl:interfaceHost+'/ossapi/oauth2/logout'}var user={loging:function(option){let _option={app_id:'5268694b62e9b9d2',redirect_uri:'https://wly.wiiqq.com/account',type:'app_admin',scope:'get_user_base',state:'MY_STATE'}_option=Object.assign(_option,option)window.location.href=urlParseParams(hrefHost,_option)},isLogin:function(option){ajax({url:userConfig.isLoginUrl,type:'post',data:{},dataType:'json',timeout:10000,contentType:"application/json",success:function(res){option.success&&option.success(res)},error:function(res){option.fail&&option.fail(res)}})},logout:function(option){ajax({url:userConfig.logoutUrl,type:'post',data:{},dataType:'json',timeout:10000,contentType:"application/json",success:function(res){option.success&&option.success(res)},error:function(res){option.fail&&option.fail(res)}})},getUserInfo:function(option){ajax({url:userConfig.userDetailUrl,type:'post',data:{},dataType:'json',timeout:10000,contentType:"application/json",success:function(res){option.success&&option.success(res)},error:function(res){option.fail&&option.fail(res)}})}}function urlParseParams(uri,params){const paramsArray=[]Object.keys(params).forEach(key=>params[key]&&paramsArray.push(`${key}=${params[key]}`))if(uri.search(/\?/)===-1){uri+=`?${paramsArray.join('&')}`}else{uri+=`&${paramsArray.join('&')}`}return uri}function ajax(options){options=options||{};options.type=(options.type||"GET").toUpperCase();options.dataType=options.dataType||"json";var params=formatParams(options.data);var xhr;if(window.XMLHttpRequest){xhr=new XMLHttpRequest()}else if(window.ActiveObject){xhr=new ActiveXobject('Microsoft.XMLHTTP')}if(options.type=="GET"){xhr.open("GET",options.url+"?"+params,true);xhr.send(null)}else if(options.type=="POST"){xhr.open("post",options.url,true);xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(params)}setTimeout(function(){if(xhr.readySate!=4){xhr.abort()}},options.timeout)if(xhr.readyState==4){var status=xhr.status;if(status>=200&&status<300||status==304){options.success&&options.success(xhr.responseText,xhr.responseXML)}else{options.error&&options.error(status)}}else{options.error&&options.error(status)}}function formatParams(data){var arr=[];for(var name in data){arr.push(encodeURIComponent(name)+"="+encodeURIComponent(data[name]))}arr.push(("v="+Math.random()).replace(".",""));return arr.join("&")}
